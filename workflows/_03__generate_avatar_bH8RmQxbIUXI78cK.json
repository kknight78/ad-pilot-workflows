{
  "updatedAt": "2025-12-10T01:14:06.000Z",
  "createdAt": "2025-11-22T14:53:42.780Z",
  "id": "bH8RmQxbIUXI78cK",
  "name": "[03] Generate Avatar",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "amount": 20
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        480,
        1648
      ],
      "id": "6ca0f276-1654-44f8-baf9-b4f94ede4825",
      "name": "Wait",
      "webhookId": "a6450418-423b-411d-872d-223ca0619b51"
    },
    {
      "parameters": {
        "jsCode": "// Single error - format it for the email\nconst error = $input.first().json;\nconst nodeName = error.node?.name || 'Unknown node';\n\n// Handle different error formats from different APIs\nlet errorMsg = 'Unknown error';\n\n// HeyGen error format: { \"error\": { \"code\": \"...\", \"message\": \"...\", \"detail\": \"...\" } }\nif (error.error?.code && error.error?.message) {\n  errorMsg = `[${error.error.code}] ${error.error.message}`;\n  if (error.error.detail) {\n    errorMsg += ` - ${error.error.detail}`;\n  }\n}\n// Cloudinary error format: { \"error\": { \"message\": \"...\" } }\nelse if (error.error?.message) {\n  errorMsg = error.error.message;\n}\n// ElevenLabs error format: { \"error\": { \"code\": \"...\", \"message\": \"...\" } }\n// (Same structure as HeyGen but without detail field - handled by first condition)\n// Generic message fallback\nelse if (error.message) {\n  errorMsg = error.message;\n}\n\nreturn [{\n  json: {\n    nodeName: nodeName,\n    errorMessage: errorMsg,\n    timestamp: new Date().toISOString(),\n    rawError: JSON.stringify(error, null, 2) // Include full error for debugging\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -592,
        1600
      ],
      "id": "83a8f36d-0e32-4e47-a8b1-edf9a4cc0cde",
      "name": "Format Create Avatar Video Errors"
    },
    {
      "parameters": {
        "errorMessage": "Avatar video errored out."
      },
      "type": "n8n-nodes-base.stopAndError",
      "typeVersion": 1,
      "position": [
        -336,
        1600
      ],
      "id": "45663354-74b7-458a-a21d-75d959756395",
      "name": "Stop and Error"
    },
    {
      "parameters": {
        "content": "# #2 Generate Avatar Video",
        "height": 864,
        "width": 1680,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -688,
        1024
      ],
      "typeVersion": 1,
      "id": "2d4ab4c4-5e9b-42a3-b2dc-7eb4c265836b",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## Error path",
        "height": 224,
        "width": 432,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -624,
        1536
      ],
      "typeVersion": 1,
      "id": "0948db8b-f71b-4d80-bfbd-fb10cbbb5c9f",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## Success path",
        "height": 208,
        "width": 224,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        608,
        1424
      ],
      "typeVersion": 1,
      "id": "4b60bfe9-ddea-4eb4-9b45-c6a667ae4f73",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "\n  {\n    \"template_id\": \"TEMP_001\",\n    \"theme\": \"Turkey day specials\",\n    \"topic\": \"\",\n    \"platform\": \"youtube\",\n    \"include_animation\": false,\n    \"avatar_id\": \"5b9c75a2f13e4d60b09bcfdafa7339dd\",\n    \"voice_id\": \"91cf853f9a91452486ba8ae00a963160\",\n    \"chromakey_color\": \"#6da264\",\n    \"chromakey_sensitivity\": \"8\",\n    \"avatar_name\": \"Kelly\",\n    \"script_length\": \"quick\",\n    \"email\": \"kelly@kellyrae.net\",\n    \"vins\": [\n      \"2C3CDXHG2PH583306\"\n    ],\n    \"test_mode\": true,\n    \"script\": {\n      \"hook\": \"Turkey day specials are here at Capitol Car Credit! Gobble, gobble!\",\n      \"segments\": [\n        \"This twenty twenty-three Dodge Charger with powerful V-six engine is just twenty-eight thousand nine ninety-five! Drive it to you family Thanksgiving celebration.\"\n      ],\n      \"cta\": \"Call two one seven, eight nine three, eight two three two - financing available for qualified buyers! Thanks for your attention to this matter.\",\n      \"full_script\": \"Turkey day specials are here at Capitol Car Credit! Gobble, gobble! This twenty twenty-three Dodge Charger with powerful V-six engine is just twenty-eight thousand nine ninety-five! Drive it to you family Thanksgiving celebration. Call two one seven, eight nine three, eight two three two - financing available for qualified buyers! Thanks for your attention to this matter.\",\n      \"notes\": \"Emphasized Turkey Day theme in hook, highlighted the V6 power for young buyers who want performance, used phone number for direct contact, and included financing mention to help buyers see ownership is possible.\",\n      \"body\": \"This twenty twenty-three Dodge Charger with powerful V-six engine is just twenty-eight thousand nine ninety-five! Drive it to you family Thanksgiving celebration.\"\n    },\n    \"script_edited\": true,\n    \"job_id\": \"4b72321e\",\n    \"vehicles\": [\n      {\n        \"vin\": \"2C3CDXHG2PH583306\",\n        \"year\": 2023,\n        \"make\": \"Dodge\",\n        \"model\": \"Charger\",\n        \"price\": 28995,\n        \"mileage\": 63339,\n        \"image_url\": \"https://imageserver.promaxinventory.com/9199/image/d2996d18b9094c75048264b550abf730.jpg\",\n        \"url\": \"https://www.ccrantoul.com/VehicleDetails/9199/91116\",\n        \"features\": [\n          \"V6 3.6 Liter\",\n          \"RWD\",\n          \"BLACK\"\n        ]\n      }\n    ],\n    \"shared_system_prompt\": \"You are an expert TikTok car ad copywriter for Capitol Car Credit, a dealership in Rantoul, Illinois.\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nâ±ï¸ SCRIPT LENGTH TARGET: 15-30 seconds\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nPACING: Fast-paced, punchy, only the most critical selling points\\nHook: 3-4 seconds\\nCall to Action: 4-5 seconds\\n\\nCRITICAL: Your script MUST fit within the 15-30 seconds time frame when spoken naturally.\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ¯ YOUR TOP 3 PRIORITIES (ALWAYS EMPHASIZE IN THIS ORDER):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\n1. PRICE - Specific prices, savings, deals, value for money\\n   - Mention actual prices clearly\\n   - Use \\\"Just [price]\\\" for under $20K to emphasize affordability\\n   - Make it sound like a great deal\\n\\n2. SELECTION - Show variety and options\\n   - Multiple vehicle types available\\n   - Something for everyone\\n   - Wide range to choose from\\n\\n3. FINANCING - Available for qualified buyers (THIS IS A HUGE DRAW!)\\n   - Mention financing naturally in CTA when possible\\n   - Use legally compliant language ONLY\\n   - Help buyers see ownership is possible\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ‘¥ TARGET AUDIENCE:\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nFirst-time buyers, young professionals (18-30), and budget-conscious families\\n\\nTHEIR PRIORITIES (based on market research):\\n- Affordability and value (PRICE matters most!)\\n- Fuel efficiency (56% of buyers say this is #1 priority)\\n- Safety features (55% prioritize this - especially families with kids)\\n- Reliability and low maintenance\\n- Modern tech features (smartphone integration, backup camera)\\n- Practical benefits (AWD for winters, cargo space)\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ™ï¸ TEXT-TO-SPEECH FORMATTING (CRITICAL):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nNUMBERS:\\n- Write as words: \\\"twenty-one thousand\\\" not \\\"$21,000\\\"\\n- Years: \\\"twenty twenty-four\\\" not \\\"2024\\\"\\n- Abbreviations: \\\"all-wheel drive\\\" not \\\"AWD\\\"\\n- Write for natural speech, not reading\\n\\nPRICE FORMATTING:\\nUnder $20,000:\\n  - ALWAYS use \\\"Just\\\" before price (emphasizes value/affordability)\\n  - Examples: \\\"Just fourteen nine nine five\\\", \\\"Just seventeen thousand\\\"\\n  \\n$20,000 and above:\\n  - ALWAYS include \\\"thousand\\\" (avoids confusion)\\n  - Examples: \\\"Twenty-one thousand\\\", \\\"Forty-eight thousand nine ninety-five\\\"\\n  - NEVER: \\\"twenty-one nine nine five\\\" (confusing without context)\\n\\nDO NOT MENTION:\\n- Mileage (displayed on screen)\\n- Complex technical specs (keep it simple)\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ¯ FEATURE SELECTION PRIORITY:\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nPick the HIGHEST tier feature available for each vehicle.\\n\\nTIER 1 - VALUE & AFFORDABILITY (mention FIRST):\\n  - Low Mileage: \\\"Only XX thousand miles!\\\" or \\\"Just XX thousand miles!\\\"\\n  - Fuel Efficiency: \\\"Great gas mileage\\\", \\\"Save at the pump\\\", \\\"Hybrid power\\\"\\n  - Reliable Brand: \\\"Reliable Toyota/Honda/Acura\\\"\\n  - Great Price: Emphasize value\\n\\nTIER 2 - SAFETY (frame with FAMILY PROTECTION):\\n  âš ï¸ IMPORTANT: Safety features should emphasize protecting loved ones!\\n  \\n  - Camera: Multi-View â†’ \\\"Three-sixty camera keeps your family safe\\\"\\n  - Blind-Spot Information System â†’ \\\"Protect your loved ones with blind spot monitoring\\\"\\n  - Lane Departure Warning â†’ \\\"Keep your kids safe with lane keeping assist\\\"\\n  - Parking Sensors â†’ \\\"Park with confidence - front and rear sensors\\\"\\n  - Adaptive Cruise Control â†’ \\\"Safer highway driving for family road trips\\\"\\n  - Backup Camera â†’ \\\"See what's behind you to protect your family\\\"\\n  - Collision Warning â†’ \\\"Advanced safety to keep everyone safe\\\"\\n\\nTIER 3 - DESIRABILITY & PRACTICALITY (high-appeal features):\\n  - Power Moonroof/Sunroof â†’ \\\"Enjoy the open air!\\\" (young buyers love this!)\\n  - Heated Seats â†’ \\\"Stay warm in Illinois winters\\\"\\n  - Third Row Seating â†’ \\\"Room for the whole family\\\" or \\\"Seats seven\\\"\\n  - AWD/4X4 â†’ \\\"Handle any weather with all-wheel drive\\\"\\n  - Apple CarPlay/Android Auto â†’ \\\"Stay connected on the go\\\"\\n  - Spacious Cargo â†’ \\\"Plenty of room for gear\\\"\\n\\nTIER 4 - COMFORT BONUSES:\\n  - Power Liftgate â†’ \\\"Easy loading\\\"\\n  - Navigation System â†’ \\\"Never get lost\\\"\\n  - Premium Sound â†’ \\\"Concert-quality audio\\\"\\n  - LED Headlamps â†’ \\\"Better visibility\\\"\\n  - Keyless Entry â†’ \\\"Modern convenience\\\"\\n  - Leather Seats â†’ \\\"Luxury interior\\\"\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ—£ï¸ BRAND PRONUNCIATIONS (CRITICAL - NEVER DEVIATE):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nâš ï¸ Hyundai â†’ ALWAYS \\\"Hunday\\\" (NEVER \\\"High-un-die\\\" or \\\"Hoon-die\\\")\\nâš ï¸ Nissan â†’ ALWAYS \\\"Neesawn\\\" (NEVER \\\"Niss-an\\\" or \\\"Knee-zon\\\" or \\\"Ni-Shuan\\\" or \\\"Niece-on\\\")\\n- Acura â†’ \\\"Ack-yuh-ruh\\\"\\n- Porsche â†’ \\\"Por-shuh\\\"\\n- Chevrolet â†’ \\\"Shevra-lay\\\"\\n- BMW â†’ \\\"B M W\\\" (with spaces)\\n- Mercedes-Benz â†’ \\\"Mer-say-deez Benz\\\"\\n- Mazda â†’ \\\"Moz-duh\\\" (not \\\"Maz-duh\\\")\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nâš–ï¸ LEGAL COMPLIANCE (CRITICAL):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nâŒ NEVER SAY:\\n- \\\"Guaranteed approval\\\"\\n- \\\"Anyone can get financed\\\"\\n- \\\"Bad credit? No problem!\\\"\\n- Any promise of financing approval\\n\\nâœ… INSTEAD USE:\\n- \\\"Financing available for qualified buyers\\\"\\n- \\\"Talk to us about financing options\\\"\\n- \\\"We work with you on financing\\\"\\n- \\\"Ask about our financing programs\\\"\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ“ DEALERSHIP CONTACT INFO:\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nCapitol Car Credit\\n125 North Century Boulevard, Rantoul, Illinois 61866\\n\\nSales Phone: (217) 893-8232\\n\\nFOR TEXT-TO-SPEECH:\\n- Address: \\\"one twenty-five North Century Boulevard, Ran-tool\\\"\\n- Phone: \\\"two one seven, eight nine three, eight two three two\\\"\\n- Website: \\\"Capitol Car Credit dot com\\\"\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ“¢ CALL TO ACTION REQUIREMENTS:\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nMUST INCLUDE:\\n1. ONE contact method (phone OR address OR website - NOT all three!)\\n2. Natural transition phrase: \\\"Get it at\\\", \\\"Visit us at\\\", \\\"Head to\\\", \\\"Stop by\\\", \\\"Call us at\\\"\\n3. Mention financing when natural (strongly encouraged - it's a big draw!)\\n\\nCTA EXAMPLES (WITH FINANCING):\\nâœ… \\\"Get it at Capitol Car Credit in Ran-tool - financing available for qualified buyers!\\\"\\nâœ… \\\"Visit Capitol Car Credit dot com - we'll work with you on financing!\\\"\\nâœ… \\\"Stop by one twenty-five North Century in Ran-tool - talk to us about financing!\\\"\\nâœ… \\\"Call two one seven, eight nine three, eight two three two - financing programs available!\\\"\\n\\nCTA EXAMPLES (WITHOUT FINANCING - still okay):\\nâœ… \\\"Head to Capitol Car Credit in Ran-tool today!\\\"\\nâœ… \\\"Visit us at one twenty-five North Century Boulevard!\\\"\\n\\nâŒ BAD EXAMPLES:\\n- Too much info: \\\"Visit us at 125 N Century Blvd, call 217-893-8232, or go to CapitolCarCredit.com!\\\"\\n- Too pushy: \\\"Bad credit? No problem! Everyone approved!\\\"\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ¨ THEME HANDLING (when provided by user):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nIf a THEME is provided:\\n- Use it in the HOOK (opening sentence) and, optionally, in the segments and CTA if time allows\\n- Make the hook tie naturally into the theme\\n- Examples:\\n  * Theme \\\"Black Friday\\\" â†’ \\\"Black Friday deals are here at Capitol Car Credit!\\\"\\n  * Theme \\\"Winter weather\\\" â†’ \\\"Ready for Illinois winters? We've got you covered!\\\"\\n  * Theme \\\"First-time buyers\\\" â†’ \\\"First car? We make it easy!\\\"\\n\\nIf NO theme provided:\\n- Use a generic attention-grabber about value/selection/deals\\n- Examples: \\\"Check out these deals!\\\", \\\"Selection is hot right now!\\\"\\n\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ“‹ OUTPUT FORMAT (JSON):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\n{\\n  \\\"hook\\\": \\\"Opening sentence (3-4 seconds)\\\",\\n  \\\"segments\\\": [\\n    \\\"Segment 1 (timing varies by template)\\\",\\n    \\\"Segment 2\\\",\\n    ...\\n  ],\\n  \\\"cta\\\": \\\"Call to action with ONE contact method + optional financing mention (4-5 seconds)\\\",\\n  \\\"full_script\\\": \\\"Complete script: hook + all segments + cta + [pause 1 second]\\\",\\n  \\\"notes\\\": \\\"Brief creative notes\\\"\\n}\\n\\nCRITICAL FORMATTING:\\n- \\\"segments\\\" array = core content (varies by template type)\\n- ALWAYS end full_script with \\\"[pause 1 second]\\\"\\n- This allows avatar to return to resting face before video cuts\\n- Output ONLY valid JSON (no markdown, no backticks)\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ¯ REMEMBER THE BIG 3:\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nEvery script should emphasize:\\n1. PRICE - Specific, clear, sounds like a deal\\n2. SELECTION - Variety and options available\\n3. FINANCING - Available for qualified buyers (mention when natural!)\\n\\nThis is what sets Capitol Car Credit apart!\",\n    \"timing_guidance\": {\n      \"target\": \"15-30 seconds\",\n      \"hook\": \"3-4 seconds\",\n      \"cta\": \"4-5 seconds\",\n      \"style\": \"Fast-paced, punchy, only the most critical selling points\"\n    },\n    \"system_prompt\": \"You are an expert TikTok car ad copywriter for Capitol Car Credit, a dealership in Rantoul, Illinois.\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nâ±ï¸ SCRIPT LENGTH TARGET: 15-30 seconds\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nPACING: Fast-paced, punchy, only the most critical selling points\\nHook: 3-4 seconds\\nCall to Action: 4-5 seconds\\n\\nCRITICAL: Your script MUST fit within the 15-30 seconds time frame when spoken naturally.\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ¯ YOUR TOP 3 PRIORITIES (ALWAYS EMPHASIZE IN THIS ORDER):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\n1. PRICE - Specific prices, savings, deals, value for money\\n   - Mention actual prices clearly\\n   - Use \\\"Just [price]\\\" for under $20K to emphasize affordability\\n   - Make it sound like a great deal\\n\\n2. SELECTION - Show variety and options\\n   - Multiple vehicle types available\\n   - Something for everyone\\n   - Wide range to choose from\\n\\n3. FINANCING - Available for qualified buyers (THIS IS A HUGE DRAW!)\\n   - Mention financing naturally in CTA when possible\\n   - Use legally compliant language ONLY\\n   - Help buyers see ownership is possible\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ‘¥ TARGET AUDIENCE:\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nFirst-time buyers, young professionals (18-30), and budget-conscious families\\n\\nTHEIR PRIORITIES (based on market research):\\n- Affordability and value (PRICE matters most!)\\n- Fuel efficiency (56% of buyers say this is #1 priority)\\n- Safety features (55% prioritize this - especially families with kids)\\n- Reliability and low maintenance\\n- Modern tech features (smartphone integration, backup camera)\\n- Practical benefits (AWD for winters, cargo space)\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ™ï¸ TEXT-TO-SPEECH FORMATTING (CRITICAL):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nNUMBERS:\\n- Write as words: \\\"twenty-one thousand\\\" not \\\"$21,000\\\"\\n- Years: \\\"twenty twenty-four\\\" not \\\"2024\\\"\\n- Abbreviations: \\\"all-wheel drive\\\" not \\\"AWD\\\"\\n- Write for natural speech, not reading\\n\\nPRICE FORMATTING:\\nUnder $20,000:\\n  - ALWAYS use \\\"Just\\\" before price (emphasizes value/affordability)\\n  - Examples: \\\"Just fourteen nine nine five\\\", \\\"Just seventeen thousand\\\"\\n  \\n$20,000 and above:\\n  - ALWAYS include \\\"thousand\\\" (avoids confusion)\\n  - Examples: \\\"Twenty-one thousand\\\", \\\"Forty-eight thousand nine ninety-five\\\"\\n  - NEVER: \\\"twenty-one nine nine five\\\" (confusing without context)\\n\\nDO NOT MENTION:\\n- Mileage (displayed on screen)\\n- Complex technical specs (keep it simple)\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ¯ FEATURE SELECTION PRIORITY:\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nPick the HIGHEST tier feature available for each vehicle.\\n\\nTIER 1 - VALUE & AFFORDABILITY (mention FIRST):\\n  - Low Mileage: \\\"Only XX thousand miles!\\\" or \\\"Just XX thousand miles!\\\"\\n  - Fuel Efficiency: \\\"Great gas mileage\\\", \\\"Save at the pump\\\", \\\"Hybrid power\\\"\\n  - Reliable Brand: \\\"Reliable Toyota/Honda/Acura\\\"\\n  - Great Price: Emphasize value\\n\\nTIER 2 - SAFETY (frame with FAMILY PROTECTION):\\n  âš ï¸ IMPORTANT: Safety features should emphasize protecting loved ones!\\n  \\n  - Camera: Multi-View â†’ \\\"Three-sixty camera keeps your family safe\\\"\\n  - Blind-Spot Information System â†’ \\\"Protect your loved ones with blind spot monitoring\\\"\\n  - Lane Departure Warning â†’ \\\"Keep your kids safe with lane keeping assist\\\"\\n  - Parking Sensors â†’ \\\"Park with confidence - front and rear sensors\\\"\\n  - Adaptive Cruise Control â†’ \\\"Safer highway driving for family road trips\\\"\\n  - Backup Camera â†’ \\\"See what's behind you to protect your family\\\"\\n  - Collision Warning â†’ \\\"Advanced safety to keep everyone safe\\\"\\n\\nTIER 3 - DESIRABILITY & PRACTICALITY (high-appeal features):\\n  - Power Moonroof/Sunroof â†’ \\\"Enjoy the open air!\\\" (young buyers love this!)\\n  - Heated Seats â†’ \\\"Stay warm in Illinois winters\\\"\\n  - Third Row Seating â†’ \\\"Room for the whole family\\\" or \\\"Seats seven\\\"\\n  - AWD/4X4 â†’ \\\"Handle any weather with all-wheel drive\\\"\\n  - Apple CarPlay/Android Auto â†’ \\\"Stay connected on the go\\\"\\n  - Spacious Cargo â†’ \\\"Plenty of room for gear\\\"\\n\\nTIER 4 - COMFORT BONUSES:\\n  - Power Liftgate â†’ \\\"Easy loading\\\"\\n  - Navigation System â†’ \\\"Never get lost\\\"\\n  - Premium Sound â†’ \\\"Concert-quality audio\\\"\\n  - LED Headlamps â†’ \\\"Better visibility\\\"\\n  - Keyless Entry â†’ \\\"Modern convenience\\\"\\n  - Leather Seats â†’ \\\"Luxury interior\\\"\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ—£ï¸ BRAND PRONUNCIATIONS (CRITICAL - NEVER DEVIATE):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nâš ï¸ Hyundai â†’ ALWAYS \\\"Hunday\\\" (NEVER \\\"High-un-die\\\" or \\\"Hoon-die\\\")\\nâš ï¸ Nissan â†’ ALWAYS \\\"Neesawn\\\" (NEVER \\\"Niss-an\\\" or \\\"Knee-zon\\\" or \\\"Ni-Shuan\\\" or \\\"Niece-on\\\")\\n- Acura â†’ \\\"Ack-yuh-ruh\\\"\\n- Porsche â†’ \\\"Por-shuh\\\"\\n- Chevrolet â†’ \\\"Shevra-lay\\\"\\n- BMW â†’ \\\"B M W\\\" (with spaces)\\n- Mercedes-Benz â†’ \\\"Mer-say-deez Benz\\\"\\n- Mazda â†’ \\\"Moz-duh\\\" (not \\\"Maz-duh\\\")\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nâš–ï¸ LEGAL COMPLIANCE (CRITICAL):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nâŒ NEVER SAY:\\n- \\\"Guaranteed approval\\\"\\n- \\\"Anyone can get financed\\\"\\n- \\\"Bad credit? No problem!\\\"\\n- Any promise of financing approval\\n\\nâœ… INSTEAD USE:\\n- \\\"Financing available for qualified buyers\\\"\\n- \\\"Talk to us about financing options\\\"\\n- \\\"We work with you on financing\\\"\\n- \\\"Ask about our financing programs\\\"\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ“ DEALERSHIP CONTACT INFO:\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nCapitol Car Credit\\n125 North Century Boulevard, Rantoul, Illinois 61866\\n\\nSales Phone: (217) 893-8232\\n\\nFOR TEXT-TO-SPEECH:\\n- Address: \\\"one twenty-five North Century Boulevard, Ran-tool\\\"\\n- Phone: \\\"two one seven, eight nine three, eight two three two\\\"\\n- Website: \\\"Capitol Car Credit dot com\\\"\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ“¢ CALL TO ACTION REQUIREMENTS:\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nMUST INCLUDE:\\n1. ONE contact method (phone OR address OR website - NOT all three!)\\n2. Natural transition phrase: \\\"Get it at\\\", \\\"Visit us at\\\", \\\"Head to\\\", \\\"Stop by\\\", \\\"Call us at\\\"\\n3. Mention financing when natural (strongly encouraged - it's a big draw!)\\n\\nCTA EXAMPLES (WITH FINANCING):\\nâœ… \\\"Get it at Capitol Car Credit in Ran-tool - financing available for qualified buyers!\\\"\\nâœ… \\\"Visit Capitol Car Credit dot com - we'll work with you on financing!\\\"\\nâœ… \\\"Stop by one twenty-five North Century in Ran-tool - talk to us about financing!\\\"\\nâœ… \\\"Call two one seven, eight nine three, eight two three two - financing programs available!\\\"\\n\\nCTA EXAMPLES (WITHOUT FINANCING - still okay):\\nâœ… \\\"Head to Capitol Car Credit in Ran-tool today!\\\"\\nâœ… \\\"Visit us at one twenty-five North Century Boulevard!\\\"\\n\\nâŒ BAD EXAMPLES:\\n- Too much info: \\\"Visit us at 125 N Century Blvd, call 217-893-8232, or go to CapitolCarCredit.com!\\\"\\n- Too pushy: \\\"Bad credit? No problem! Everyone approved!\\\"\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ¨ THEME HANDLING (when provided by user):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nIf a THEME is provided:\\n- Use it in the HOOK (opening sentence) and, optionally, in the segments and CTA if time allows\\n- Make the hook tie naturally into the theme\\n- Examples:\\n  * Theme \\\"Black Friday\\\" â†’ \\\"Black Friday deals are here at Capitol Car Credit!\\\"\\n  * Theme \\\"Winter weather\\\" â†’ \\\"Ready for Illinois winters? We've got you covered!\\\"\\n  * Theme \\\"First-time buyers\\\" â†’ \\\"First car? We make it easy!\\\"\\n\\nIf NO theme provided:\\n- Use a generic attention-grabber about value/selection/deals\\n- Examples: \\\"Check out these deals!\\\", \\\"Selection is hot right now!\\\"\\n\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ“‹ OUTPUT FORMAT (JSON):\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\n{\\n  \\\"hook\\\": \\\"Opening sentence (3-4 seconds)\\\",\\n  \\\"segments\\\": [\\n    \\\"Segment 1 (timing varies by template)\\\",\\n    \\\"Segment 2\\\",\\n    ...\\n  ],\\n  \\\"cta\\\": \\\"Call to action with ONE contact method + optional financing mention (4-5 seconds)\\\",\\n  \\\"full_script\\\": \\\"Complete script: hook + all segments + cta + [pause 1 second]\\\",\\n  \\\"notes\\\": \\\"Brief creative notes\\\"\\n}\\n\\nCRITICAL FORMATTING:\\n- \\\"segments\\\" array = core content (varies by template type)\\n- ALWAYS end full_script with \\\"[pause 1 second]\\\"\\n- This allows avatar to return to resting face before video cuts\\n- Output ONLY valid JSON (no markdown, no backticks)\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ¯ REMEMBER THE BIG 3:\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nEvery script should emphasize:\\n1. PRICE - Specific, clear, sounds like a deal\\n2. SELECTION - Variety and options available\\n3. FINANCING - Available for qualified buyers (mention when natural!)\\n\\nThis is what sets Capitol Car Credit apart!\\n\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸš— MULTI-CAR AD SPECIFIC RULES:\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\nSTYLE: FAST, PUNCHY, SCROLL-STOPPING\\nSCRIPT LENGTH: 15-30 seconds\\n\\nTIMING TARGETS FOR 1 VEHICLE(S):\\n- Hook: 3-4 seconds\\n- Each vehicle segment: 4-5 seconds each\\n- CTA: 4-5 seconds\\n- Total target: 15-18 seconds\\n\\nPACING: Fast-paced, punchy, only the most critical selling points\\n\\nSCRIPT STRUCTURE:\\n1. HOOK (3-4 seconds): ONE punchy sentence that grabs attention\\n2. SEGMENTS - ONE PER CAR (4-5 seconds each): Price + ONE killer feature\\n3. CTA (4-5 seconds): Dealership name + ONE contact method (address, phone number, or url) + financing mention\\n  - Examples:\\n    - URL: \\\"Find Capitol Car Credit's full inventory at C C Ran-tool dot com\\\"\\n    - ADDRESS: \\\"Visit us at Capitol Car Credit at one twenty five, North Century Boulevard in Ran-tool\\\"\\n    - PHONE NUMBER: \\\"Contact Capitol Car Credit at two one seven, eight nine three, eight two three two, we're waiting to hear from you!\\\"\\n\\nSTYLE GUIDE:\\nâœ… SHORT sentences (5-8 words max per sentence for quick, 8-12 for standard, 12-15 for detailed)\\nâœ… ONE feature per car\\nâœ… Fast-paced, energetic, value-focused\\nâœ… Price FIRST for each car\\nâœ… Emphasize VALUE: \\\"easy on your wallet\\\", \\\"great deal\\\", \\\"reliable\\\"\\n\\nâŒ NO long descriptions (unless detailed script)\\nâŒ NO multiple features per car (unless standard/detailed)\\nâŒ NO repetitive features across cars in same ad\\n\\nFEATURE DIVERSITY (CRITICAL):\\nâš ï¸ Use DIFFERENT features for each car in the ad!\\n\\nGOOD (varied): \\n- \\\"Just fourteen nine nine five for this low mileage Accord!\\\"\\n- \\\"Just seventeen thousand for this all-wheel drive Civic with heated seats!\\\" \\n- \\\"Just twelve nine ninety-five for this reliable Camry with great gas mileage!\\\"\\n\\nBAD (repetitive):\\n- \\\"Low mileage Accord!\\\"\\n- \\\"Low mileage Civic!\\\"\\n- \\\"Low mileage Camry!\\\" â† BORING!\\n\\nIf multiple cars have the same top feature, pick the NEXT BEST feature from a different tier.\",\n    \"user_prompt\": \"Generate a 15-30 seconds script for this TikTok car ad:\\n\\nTHEME: Turkey day specials\\n\\nVEHICLES (1 total):\\n\\n1. 2023 Dodge Charger\\n   Price: $28,995 (Use: \\\"[price] thousand\\\")\\n   TOP Features: V6 3.6 Liter, RWD, BLACK\\n   (Pick ONE - make sure each car gets a DIFFERENT feature!)\\n\\nREQUIREMENTS:\\n1. Hook: ONE punchy sentence (theme: \\\"Turkey day specials\\\") (3-4 seconds)\\n2. Each car segment: Price + ONE feature (4-5 seconds each)\\n3. CTA: Transition phrase + dealership + ONE contact (phone number, url, or address) + financing mention (4-5 seconds)\\n4. Target length: 15-18 seconds\\n5. Pacing: Fast-paced, punchy, only the most critical selling points\\n6. âš ï¸ CRITICAL: Use DIFFERENT features for each car! Variety keeps it interesting!\\n7. END with \\\"[pause 1 second]\\\" for avatar resting face\\n\\nOUTPUT AS JSON:\\n{\\n  \\\"hook\\\": \\\"ONE punchy sentence here\\\",\\n  \\\"segments\\\": [\\n    \\\"2023 Dodge description (4-5 seconds each)\\\"\\n  ],\\n  \\\"cta\\\": \\\"Call to action with ONE contact + financing mention\\\",\\n  \\\"full_script\\\": \\\"hook + all segments + cta + [pause 1 second]\\\",\\n  \\\"notes\\\": \\\"Your notes\\\"\\n}\\n\\nRemember: Fast-paced, punchy, only the most critical selling points, DIFFERENT features per car, PROPER price formatting, CORRECT brand pronunciations, MENTION FINANCING!\",\n    \"target_duration\": \"15-18 seconds\"\n  }\n",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -464,
        1168
      ],
      "id": "1942a1bc-a9fa-48ee-b2d6-0f22232d6992",
      "name": "Edit Fields",
      "disabled": true
    },
    {
      "parameters": {
        "inputSource": "passthrough"
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -608,
        1168
      ],
      "id": "71d541bd-13bd-48f5-8587-41e030ed86c4",
      "name": "When Executed by Orchestrate Video Creation"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "cca8b346-501c-45ab-a0b4-b85747732f3a",
              "leftValue": "={{ $json.template_id }}",
              "rightValue": "ad-multi-item-1",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "1abfa12b-6a58-43be-b3c7-7c40f9b28f3b",
              "leftValue": "={{ $json.template_id }}",
              "rightValue": "ad-single-item-spotlight-1",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "or"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        304,
        1152
      ],
      "id": "592a02ca-c6fe-45dd-bc03-34f39640c1c1",
      "name": "If: Needs Section Timings"
    },
    {
      "parameters": {
        "fromEmail": "errors@ad-pilot.ai",
        "toEmail": "kelly@ad-pilot.ai",
        "subject": "=ğŸš¨ Avatar Generation Failed - {{ $json.nodeName }}",
        "html": "={{ \"âš ï¸ Create Avatar Video Workflow Error\\n\\n\" +\n\"Failed Node: \" + $json.nodeName + \"\\n\" +\n\"Error: \" + $json.errorMessage + \"\\n\\n\" +\n\"Time: \" + $json.timestamp + \"\\n\\n\" +\n\"Check n8n: https://kelly-ads.app.n8n.cloud/\" }}",
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        -464,
        1600
      ],
      "id": "388cb3e1-b5d4-408a-adff-25ac9da4c94b",
      "name": "Send Email",
      "webhookId": "f0d4ff60-459c-4285-80e3-063a8a76c8da",
      "credentials": {
        "smtp": {
          "id": "5HPC3NyTgaxCbH6e",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "7e530ea0-2545-43a0-a589-1b816442e116",
              "leftValue": "={{$json.data?.status}}",
              "rightValue": "completed",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        368,
        1504
      ],
      "id": "9846f443-1045-48d3-b62b-65605ad87abe",
      "name": "If: Avatar Complete"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "24b32897-40c6-4f03-9db3-9cf8448af739",
              "leftValue": "={{ $json.api_heygen_create_avatar }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -112,
        1472
      ],
      "id": "24e72cde-e2ff-4e25-9bc3-ae862d45689b",
      "name": "If: Test, Skip Avatar"
    },
    {
      "parameters": {
        "jsCode": "return [{\n  json: $json.api_heygen_create_avatar\n}]"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16,
        1424
      ],
      "id": "308ab91d-9c1a-4da3-8fb2-aab2651ebe83",
      "name": "Skip Avatar"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.heygen.com/v2/video/generate",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "x-api-key",
              "value": "OWQxZDRjZmUxMmI4NDIzMDg2NjI3NTRmYWJlNTdmMTgtMTc1OTM0MjExNQ=="
            },
            {
              "name": "accept",
              "value": "application/json"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"title\": \"Shad ad draft\",\n  \"video_inputs\": [\n    {\n      \"character\": {\n        \"type\": \"talking_photo\",\n        \"talking_photo_id\": \"{{ $json.avatar_id }}\"\n      },\n      \"voice\": {\n        \"type\": \"audio\",\n        \"audio_url\": \"{{ $json.audio_url }}\"\n      }\n    }\n  ],\n  \"dimension\": { \"width\": 720, \"height\": 1250 }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        16,
        1568
      ],
      "id": "41635a5e-64ee-4720-8a74-bd9e4ae27928",
      "name": "API: HeyGen, Create Avatar",
      "alwaysOutputData": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "url": "https://api.heygen.com/v1/video_status.get",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "video_id",
              "value": "={{ $('API: HeyGen, Create Avatar').first().json.data.video_id }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-Api-Key",
              "value": "OWQxZDRjZmUxMmI4NDIzMDg2NjI3NTRmYWJlNTdmMTgtMTc1OTM0MjExNQ=="
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        192,
        1552
      ],
      "id": "b479ea68-6a3e-4ea2-8364-ae5cba17c22f",
      "name": "API: Check Avatar Status",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "const config = $json;\nconst script = config.script;\n\n// Validate script has what we need\nif (!script.full_script) {\n  throw new Error('Script missing full_script');\n}\n\nreturn [{\n  json: {\n    ...config,\n    text: script.full_script.replace(/\\.\\s*<break/g, '<break')\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -336,
        1168
      ],
      "id": "806831e4-7c4e-441f-a9c3-3fc2c37b39db",
      "name": "Prepare Sections for TTS"
    },
    {
      "parameters": {
        "jsCode": "const apiResponse = $json;\nconst videoUrl = apiResponse.data.video_url;\nconst duration = Number(apiResponse.data.duration);\nconst config = $('Remove Data Container').first().json;\n\nreturn [{\n  json: {\n    ...config,\n    avatar_video_url: videoUrl,\n    avatar_video_duration: duration,\n\n    // Testing API Response\n    ...(config.test_mode && { api_elevenlabs_forced_alignment: apiResponse })\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        672,
        1488
      ],
      "id": "157b86f3-9999-4b3a-be9e-c299e3e278a6",
      "name": "Parse Avatar Response"
    },
    {
      "parameters": {
        "jsCode": "return [{\n  json: { data: $json.api_heygen_tts }\n}]"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -16,
        1088
      ],
      "id": "dd807b6e-c970-4cb5-b356-1659b56c5d4a",
      "name": "Skip TTS & Upload"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        640,
        1168
      ],
      "id": "1553044c-6f7a-4455-a21c-e0a78ab534bd",
      "name": "Aggregate: Configs"
    },
    {
      "parameters": {
        "jsCode": "return [{\n  json: $json.data[0]\n}]"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        816,
        1168
      ],
      "id": "a7e3614b-9810-460a-9d18-2c4e1de2e0f4",
      "name": "Remove Data Container"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.heygen.com/v2/voices/{{$json.voice_id}}/preview",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"text_type\": \"ssml\",\n  \"voice_id\": \"{{$json.voice_id}}\",\n  \"text\": \"<speak>{{$json.text}}<break time='1s'/></speak>\",\n  \"with_timestamps\": true,\n  \"speed\": \"1\",\n  \"pitch\": \"0\",\n  \"elevenlabs_settings\": {\n    \"model\": \"eleven_3\",\n    \"similarity_boost\": 5,\n    \"stability\": 75,\n    \"style\": 0\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -16,
        1232
      ],
      "id": "7e1d247c-f0ef-4807-b76d-abbc881fa6aa",
      "name": "API: HeyGen, TTS",
      "credentials": {
        "httpHeaderAuth": {
          "id": "0TuQVmfBK1fbl1lq",
          "name": "HeyGen"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "const config = $json;\nconst script = config.script;\nconst templateId = config.template_id || '';\n\n// Get HeyGen word timestamps\nconst rawTimestamps = config.heygen_tts.word_timestamps;\n\n// Filter out <start> and <end> markers and clean up words\nconst words = rawTimestamps\n  .filter(w => !w.word.startsWith('<'))\n  .map(w => ({\n    text: w.word.replace(/[.,!?;:\\-\"'()]/g, '').toLowerCase(),\n    originalText: w.word,\n    start: w.start,\n    end: w.end\n  }));\n\nconsole.log(`ğŸ“Š Total HeyGen words: ${words.length}`);\nconsole.log(`ğŸ“‹ Template: ${templateId}`);\n\n// Helper to normalize text for comparison\nconst normalizeWord = (word) => word.replace(/[.,!?;:\\-\"'()]/g, '').toLowerCase();\n\n// Build section texts based on template type\nlet sections = [];\n\nif (templateId === 'ad-single-item-spotlight-1') {\n  // SPOTLIGHT template: hero is already on screen during hook\n  // Combine hook + first segment into \"hook\" timing\n  // Then segments 1-5 are for feature photos\n  console.log('ğŸ¯ SPOTLIGHT template: combining hook + segment_0 into hook');\n\n  const combinedHookText = script.hook + ' ' + (script.segments[0] || '');\n  sections = [\n    { name: 'hook', text: combinedHookText },\n    ...script.segments.slice(1).map((text, i) => ({ name: `segment_${i + 1}`, text })),\n    { name: 'cta', text: script.cta }\n  ];\n} else {\n  // Default: standard section building (MULTI-ITEM, EDUCATIONAL, etc.)\n  sections = [\n    { name: 'hook', text: script.hook },\n    ...script.segments.map((text, i) => ({ name: `segment_${i}`, text })),\n    { name: 'cta', text: script.cta }\n  ];\n}\n\nconsole.log(`ğŸ“ Sections to process: ${sections.map(s => s.name).join(', ')}`);\n\nconst sectionTimings = [];\nlet wordIndex = 0;\n\nfor (const section of sections) {\n  // Split section text into words and normalize\n  const sectionWords = section.text\n    .split(/\\s+/)\n    .filter(w => w.length > 0)\n    .map(w => normalizeWord(w));\n\n  const wordCount = sectionWords.length;\n\n  console.log(`\\nğŸ“ Section \"${section.name}\": ${wordCount} words`);\n  console.log(`   First few: ${sectionWords.slice(0, 5).join(' ')}...`);\n\n  // Find start word\n  const startWord = words[wordIndex];\n  if (!startWord) {\n    console.warn(`âš ï¸ No start word for section ${section.name} at index ${wordIndex}`);\n    continue;\n  }\n\n  // Find end word\n  const expectedEndIndex = wordIndex + wordCount - 1;\n  const endWord = words[expectedEndIndex];\n\n  if (!endWord) {\n    console.warn(`âš ï¸ No end word for section ${section.name} at index ${expectedEndIndex}`);\n    console.warn(`   Total words available: ${words.length}, current index: ${wordIndex}`);\n    // Use last available word as fallback\n    const lastWord = words[words.length - 1];\n    if (lastWord) {\n      sectionTimings.push({\n        name: section.name,\n        start: startWord.start,\n        end: lastWord.end,\n        duration: lastWord.end - startWord.start\n      });\n    }\n    break;\n  }\n\n  // Verify the match makes sense\n  const lastSectionWord = sectionWords[wordCount - 1];\n  const timestampWord = normalizeWord(endWord.originalText);\n\n  if (lastSectionWord !== timestampWord) {\n    console.log(`   âš ï¸ Word mismatch: script=\"${lastSectionWord}\" vs heygen=\"${timestampWord}\"`);\n    console.log(`   Looking for better match...`);\n\n    // Search forward/backward a few words to find the actual match\n    let foundIndex = -1;\n    for (let offset = -3; offset <= 3; offset++) {\n      const checkIndex = expectedEndIndex + offset;\n      if (checkIndex >= 0 && checkIndex < words.length) {\n        if (normalizeWord(words[checkIndex].originalText) === lastSectionWord) {\n          foundIndex = checkIndex;\n          console.log(`   âœ“ Found match at offset ${offset}`);\n          break;\n        }\n      }\n    }\n\n    if (foundIndex !== -1) {\n      const correctedEndWord = words[foundIndex];\n      sectionTimings.push({\n        name: section.name,\n        start: startWord.start,\n        end: correctedEndWord.end,\n        duration: correctedEndWord.end - startWord.start\n      });\n      wordIndex = foundIndex + 1;\n      console.log(`   âœ“ Section timing: ${startWord.start}s - ${correctedEndWord.end}s (${(correctedEndWord.end - startWord.start).toFixed(2)}s)`);\n      continue;\n    }\n  }\n\n  sectionTimings.push({\n    name: section.name,\n    start: startWord.start,\n    end: endWord.end,\n    duration: endWord.end - startWord.start\n  });\n\n  console.log(`   âœ“ Section timing: ${startWord.start}s - ${endWord.end}s (${(endWord.end - startWord.start).toFixed(2)}s)`);\n\n  wordIndex += wordCount;\n}\n\n// Final validation\nconst totalScriptWords = sections.reduce((sum, s) => sum + s.text.split(/\\s+/).length, 0);\nconst lastTiming = sectionTimings[sectionTimings.length - 1];\nconsole.log(`\\nğŸ“Š Summary:`);\nconsole.log(`   Total script words: ${totalScriptWords}`);\nconsole.log(`   Total HeyGen words: ${words.length}`);\nconsole.log(`   Final end time: ${lastTiming?.end}s`);\nconsole.log(`   Section timings: ${sectionTimings.map(s => s.name).join(', ')}`);\n\nif (Math.abs(totalScriptWords - words.length) > 5) {\n  console.warn(`âš ï¸ Word count mismatch! Script has ${totalScriptWords} words but HeyGen has ${words.length}`);\n}\n\nreturn [{\n  json: {\n    ...config,\n    _section_timings: sectionTimings,\n\n    // Clean up api response\n    heygen_tts: undefined\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        464,
        1072
      ],
      "id": "a9085321-e6d7-4522-ac65-856ed886b9b0",
      "name": "Calculate Timings from Timestamps"
    },
    {
      "parameters": {
        "jsCode": "const apiResponse = $json.data;\nconst config = $('Prepare Sections for TTS').item.json;\n\nreturn [{\n  json: {\n    ...config,\n    audio_url: apiResponse.audio_url,\n    heygen_tts: {\n      audio_url: apiResponse.audio_url,\n      duration: apiResponse.duration,\n      word_timestamps: apiResponse.word_timestamps\n    },\n\n    // Testing API Response\n    ...(config.test_mode && { api_heygen_tts: apiResponse })\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        144,
        1152
      ],
      "id": "75a3319a-12e3-4fa2-af68-823bb2e92e8c",
      "name": "Parse TTS Response"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "e59a9fcd-5723-4be5-b2e9-52c3beb88b26",
              "leftValue": "={{ $json.api_heygen_tts }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -160,
        1168
      ],
      "id": "955525c5-cc38-4013-884a-cfde3417c6b6",
      "name": "If: Test, Skip TTS"
    }
  ],
  "connections": {
    "Wait": {
      "main": [
        [
          {
            "node": "API: Check Avatar Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Create Avatar Video Errors": {
      "main": [
        [
          {
            "node": "Send Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Prepare Sections for TTS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When Executed by Orchestrate Video Creation": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If: Needs Section Timings": {
      "main": [
        [
          {
            "node": "Calculate Timings from Timestamps",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Aggregate: Configs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Email": {
      "main": [
        [
          {
            "node": "Stop and Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If: Avatar Complete": {
      "main": [
        [
          {
            "node": "Parse Avatar Response",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If: Test, Skip Avatar": {
      "main": [
        [
          {
            "node": "Skip Avatar",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "API: HeyGen, Create Avatar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Skip Avatar": {
      "main": [
        [
          {
            "node": "If: Avatar Complete",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "API: HeyGen, Create Avatar": {
      "main": [
        [
          {
            "node": "API: Check Avatar Status",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Format Create Avatar Video Errors",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "API: Check Avatar Status": {
      "main": [
        [
          {
            "node": "If: Avatar Complete",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Format Create Avatar Video Errors",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Sections for TTS": {
      "main": [
        [
          {
            "node": "If: Test, Skip TTS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Avatar Response": {
      "main": [
        []
      ]
    },
    "Skip TTS & Upload": {
      "main": [
        [
          {
            "node": "Parse TTS Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate: Configs": {
      "main": [
        [
          {
            "node": "Remove Data Container",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Remove Data Container": {
      "main": [
        [
          {
            "node": "If: Test, Skip Avatar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "API: HeyGen, TTS": {
      "main": [
        [
          {
            "node": "Parse TTS Response",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Format Create Avatar Video Errors",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Calculate Timings from Timestamps": {
      "main": [
        [
          {
            "node": "Aggregate: Configs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If: Test, Skip TTS": {
      "main": [
        [
          {
            "node": "Skip TTS & Upload",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "API: HeyGen, TTS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse TTS Response": {
      "main": [
        [
          {
            "node": "If: Needs Section Timings",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "6222a975-d081-429a-9de7-538775f6acf1",
  "triggerCount": 0,
  "shared": [
    {
      "updatedAt": "2025-11-22T14:53:42.784Z",
      "createdAt": "2025-11-22T14:53:42.784Z",
      "role": "workflow:owner",
      "workflowId": "bH8RmQxbIUXI78cK",
      "projectId": "bll44iFOa92qb20Q"
    }
  ],
  "tags": [
    {
      "updatedAt": "2025-10-20T22:01:51.760Z",
      "createdAt": "2025-10-20T22:01:51.760Z",
      "id": "4o01JEB63Qahv9wy",
      "name": "PROD"
    }
  ]
}